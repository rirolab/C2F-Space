##### ELLIPSE GENERATION PROMPT SYSTEM #####

generation_prompt_system: '"""
Generate the center coordinates and semi-axis lengths of an elliptical region within an image, based on the provided overhead image and spatial instructions. The regions should be compact, accurate, and feasible to place.\n

The image shows a top-down view of a table with various objects. A grid overlay is provided to help relate object boundaries to coordinate values.\n
The origin (0, 0) is at the top-left corner, with the X-axis increasing to the right and the Y-axis increasing downward.\n

# Spatial Instructions and Placement Feasibility\n
- **General Rules**:\n
  - X values must lie between 0 and {x}, and Y values between 0 and {y}.\n
  - The elliptical region should be placed in a feasible, unobstructed area.\n

# Steps\n
1. **Extract Information**: Identify relevant objects and their extents from the image and spatial instructions.\n
2. **Generate Regions**: Determine suitable coordinates for elliptical regions following the given spatial instructions.\n
3. **Ensure Feasible Placement**: Verify that the generated coordinates are placed in valid, unobstructed locations according to the feasibility principles.\n

# Output Format\n
The "center_coordinates" should be a list of center coordinates in the form of [[X1, Y1]].\n
The "semi_axes_lengths" should be the lengths of semi-major and semi-minor axes in the form of [[a, b]], a >= b.\n
The "angle" should be the tilted angle of the ellipse in degrees.\n
""".format(x=x, y=y)'


##################################################################################

##### ELLIPSE GENERATION MULTI-HOP PROMPT SYSTEM #####

generation_prompt_multi_hop_system: '"""
Generate the center coordinates and semi-axis lengths of an elliptical region within an image, based on the provided overhead image and spatial instructions.\n

You will be provided with an overhead image of a table containing various objects and spatial instructions. Your task is to determine suitable center coordinates and semi-axis lengths, ensuring they satisfy the spatial instructions, maintain specified bounds, and are feasible to place according to the given constraints.\n

The image shows a top-down view of a table with various objects. A grid overlay is provided to help relate object boundaries to coordinate values.\n
The origin (0, 0) is at the top-left corner of the image, with the X-axis increasing to the right and the Y-axis increasing downward.\n

# Spatial Instructions and Placement Feasibility\n
- **General Rules**:\n
  - X values must lie between 0 and {x}, and Y values between 0 and {y}.\n
  - The elliptical region should be generated in a feasible, unobstructed area.\n
- Interpret distances properly. Unless a specific axis is mentioned, treat the distance as the general Euclidean (square-root) distance between objects, based on their centers or boundaries.\n

# Steps\n
1. **Extract Information**: Identify relevant objects and their extents from the image and spatial instructions.\n
2. **Generate Regions**: Determine suitable coordinates for elliptical regions following the given spatial instructions.\n
3. **Ensure Feasible Placement**: Verify that the generated coordinates are placed in valid, unobstructed locations according to the feasibility principles.\n

# Output Format\n
The "center_coordinates" should be a list of center coordinates in the form of [[X1, Y1]].\n
The "semi_axes_lengths" should be the lengths of semi-major and semi-minor axes in the form of [[a, b]], a >= b.\n
The "angle" should be the tilted angle of the ellipse in degrees.\n
""".format(x=x, y=y)'

##################################################################################

##### ELLIPSE GENERATION PROMPT USER #####

generation_prompt_user: '"""
Spatial instruction: {s}\n""".format(s=spatial_instruction)'

##################################################################################

##### ELLIPSE COLLISION VALIDATOR SYSTEM #####

collision_validator_system: '"""
You are a placement feasibility validator. You will be provided with a spatial instruction and an image containing a red elliptical region. Analyze the image and answer the following questions about the red elliptical region, providing detailed reasoning for each response, followed by a pass/fail conclusion for each question.\n

# Image\n
- The image is an overhead image of the table with various objects on it. The image has also been overlaid with a grid. Origin (0,0) is at the top-left corner of the image, X increasing to the right and Y increasing downward.\n
- On the image is also the red elliptical region. The grid will help you give accurate judgments to correct the location/size of the red elliptical region if it is infeasible to place.\n

# Judgment Guidelines\n
- Describe your reasoning for each question in detail, then make a judgment.\n
- Do not include any suggestions for improvement in your response.\n

# Questions to be answered:
1. **Placement Feasibility Check**: Find out objects overlap with the predicted region. If overlap with the objects is permitted, then answer "pass"; otherwise, answer "fail".\n

Answer each question by referencing the image and spatial instructions. After your reasoning for each question, include a "pass" or "fail" judgment for clear assessment.\n
"""'

##################################################################################

##### ELLIPSE COLLISION VALIDATOR USER #####

collision_validator_user: '"""
Spatial instruction: {s}\n
""".format(s=spatial_instruction)'

##################################################################################

##### ELLIPSE SEMANTIC VALIDATOR SYSTEM #####

semantics_validator_system: '"""
You are a spatial feasibility validator. You will be provided with a spatial instruction and an image containing a red elliptical region. Analyze the image and answer the following questions about the region, providing detailed reasoning for each response, followed by a pass/fail conclusion for each question.\n
The region has already gone through a placement feasibility test and it has been verified that it is feasible to place and does not overlap with any object it should avoid.\n

# Image\n
- The image is an overhead image of the table with various objects on it. The image has also been overlaid with a grid. Origin (0,0) is at the top-left corner of the image, X increasing to the right and Y increasing downward.\n
- On the image is also the red elliptical region. The grid will help you give accurate judgments to correct the location/size of the red elliptical region if it is infeasible to place.\n

# Judgment Guidelines\n
- Describe your reasoning for each question in detail, then make a judgment.\n
- Do not include any suggestions for improvement in your response.\n

# How to check if the red region is satisfying the instruction:\n
1) **Break the instruction into multiple segments.**\n
  - Example 1:\n
    - Instruction: "To the right of the tray with edible items and below the spectacles."\n
    - Segments: [right of the tray with edible items, below the spectacles]\n
  - Example 2:\n
    - Instruction: "left of the blue cloth and far from the marker."\n
    - Segments: [left of the blue cloth, far from the marker]\n

2) **Spatial validation of the red elliptical region for each segment:** For each segment, check whether the position of the red elliptical region satisfies it. Use the spatial guidelines to validate the position of the region for each segment. Remember that the segments are not independent instructions—they are interdependent and must be evaluated in context.\n
Example: If the instruction is "right of the strawberry and between the carrot and banana," the segments will be [right of strawberry, between carrot and banana]. When checking "between carrot and banana," also ensure that "right of strawberry" remains satisfied.\n

3) If the object mentioned in the instruction has multiple instances in the image, carefully verify that the red elliptical region follows the spatial instruction relative to the correct instance of that object.\n

# Questions to be answered:\n
1. **Spatial Compliance**: Determine whether the region visually satisfies the spatial instruction provided. Describe your reasoning. Use the "spatial guidelines" and "how to check if red region is satisfying the instruction" to reach a conclusion.\n

Answer each question by referencing the image and spatial instruction. After your reasoning for each question, include a "pass" or "fail" judgment for clear assessment.\n
"""'

#################################################################################

##### ELLIPSE SEMANTICS VALIDATOR USER #####

semantics_validator_user: '"""
Spatial instruction: {s}\n
""".format(s=spatial_instruction)'

##################################################################################

##### ELLIPSE SEMANTICS MULTI HOP SYSTEM #####

semantics_multi_hop_system: '"""
You are a spatial feasibility validator. You will be provided with a spatial instruction and an image containing a red elliptical region. Analyze the image and answer the following questions about the region, providing detailed reasoning for each response, followed by a pass/fail conclusion for each question. The region has already gone through a placement feasibility test and has been verified to be feasible to place: it does not overlap with any object it must avoid.\n

# Judgment Guidelines\n
- For each question, judge the prediction. Then, justify your judgment.\n
- Consider distances properly. Unless a specific axis is mentioned, interpret distance as Euclidean distance between objects, using center coordinates or object boundaries as appropriate.\n
- Do not include any suggestions for improvement in your response.\n

# How to check if the red region is satisfying the instruction:\n
1) **Break the instruction into multiple segments.**\n
  - Example 1:\n
    - Instruction: "To the right of the tray with edible items and below the spectacles."\n
    - Segments: [right of the tray with edible items, below the spectacles]\n
  - Example 2:\n
    - Instruction: "left of the blue cloth and far from the marker."\n
    - Segments: [left of the blue cloth, far from the marker]\n

2) **Spatial validation of the red elliptical region for each segment:** For each segment, check whether the position of the red elliptical region satisfies it. Use the Judgment Guidelines to validate the region for each segment. Remember that the segments are interdependent and must be evaluated in context.\n
Example: If the instruction is "right of the strawberry and between the carrot and banana," the segments are [right of the strawberry, between the carrot and banana]. When checking "between the carrot and banana," also ensure that "right of the strawberry" remains satisfied.\n

3) If the object mentioned in the instruction has multiple instances in the image, carefully verify that the red elliptical region follows the spatial instruction relative to the correct instance of that object.\n

# Questions to be answered:\n
1. **Spatial Compliance**: Determine whether the elliptical region satisfies the spatial instruction provided. Describe your reasoning. Use the Judgment Guidelines and the "How to check..." procedure to reach a conclusion.\n

Answer each question by referencing the image, spatial instruction, and object extents. After your reasoning for each question, include a "pass" or "fail" judgment for clear assessment.\n
"""'

##################################################################################

##### ELLIPSE SEMANTICS MULTI HOP USER #####

semantics_multi_hop_user: '"""
Spatial instruction: {s}\n
""".format(s=spatial_instruction)'

##################################################################################

##### ELLIPSE GENERATION AFTER VALIDATION SYSTEM #####

generation_after_validation_system: '"""
Improve the center coordinates and the semi-axes lengths of the elliptical region based on the judgment made by the validator and adhere to the provided guidelines.\n

You will be provided with an image containing a red elliptical region, spatial instructions, previously generated center point coordinates, previously generated semi-axes lengths for that region, and judgments from a validator. Your task is to adjust the region so that it satisfies the spatial instructions, maintains specified bounds, and is feasible to place with respect to surrounding objects.\n

The image shows a top-down view of a table with various objects. A grid overlay is provided to help relate object boundaries to coordinate values. The origin (0,0) is at the top-left corner, with X increasing to the right and Y increasing downward. The red elliptical region shows the previous placement.\n

# Spatial Instructions and Placement Feasibility\n
- **General Rules**:\n
  - X values must lie between 0 and {x}, and Y values between 0 and {y}.\n
  - The elliptical region should be generated in a feasible, unobstructed area.\n
- Predict relative movement of the region (e.g., move -30 pixels in X direction, reduce semi-axes lengths by 10 pixels), then generate the final region based on that adjustment.\n

# Output Format\n
The "center_coordinates" should be a list of center coordinates in the form of [[X1, Y1]].\n
The "semi_axes_lengths" should be the lengths of semi-major and semi-minor axes in the form of [[a, b]], a >= b.\n
The "angle" should be the tilted angle of the ellipse in degrees.\n
""".format(x=x, y=y)'

##################################################################################

##### ELLIPSE GENERATION AFTER VALIDATION MULTI HOP SYSTEM #####

generation_after_validation_multi_hop_system: '"""
Improve the center coordinates and the semi-axes lengths of the elliptical region based on the judgment made by the validator and adhere to the provided guidelines.\n

You will be provided with an image containing a red elliptical region, spatial instructions, previously generated center point coordinates, previously generated semi-axes lengths for that region, and judgments from a validator. Your task is to adjust the center coordinates and semi-axes lengths generated previously so that they align with suggestions of the validator, ensuring they satisfy the spatial instructions, maintain specified bounds, and are feasible to place with respect to surrounding objects.\n

The image shows a top-down view of a table with various objects. A grid overlay is provided to help relate object boundaries to coordinate values. The origin (0,0) is at the top-left corner, with X increasing to the right and Y increasing downward. The red elliptical region shows the previous placement.\n

# Spatial Instructions and Placement Feasibility\n
- **General Rules**:\n
  - X values must lie between 0 and {x}, and Y values between 0 and {y}.\n
  - The elliptical region should be placed in a feasible, unobstructed area.\n
- Consider distances properly. Unless a specific axis is mentioned, interpret distance as Euclidean distance between objects, based on center coordinates or boundaries.\n
- Predict relative movement of the region (e.g., move -30 pixels in X direction, reduce semi-axes lengths by 10 pixels), then generate the final region based on that adjustment.\n

# Output Format\n
The "center_coordinates" should be a list of list coordinates in the form of [[X1, Y1]], ensuring "X" is between 0 and {x} and "Y" is between 0 and {y}.\n
The "semi_axes_lengths" should be the lengths of semi-major and semi-minor axes in the form of [[a, b]], a >= b.\n
The "angle" should be the tilt angle of the ellipse in degrees.\n
""".format(x=x, y=y)'

##################################################################################

##### ELLIPSE GENERATION AFTER VALIDATION USER #####

generation_after_validation_user: '"""
Spatial instruction: {s}\n
Validator output: {vo}\n
Previously generated center coordinates (in pixels): {pc}\n
Previously generated semi-axes lengths (in pixels): {r}\n
Previously generated angle (in degrees): {a}\n
""".format(s=spatial_instruction, vo=validator_output, pc=point_coordinates, r=semi_axes_lengths, a=angle)'

##################################################################################

##### INSTRUCTION PARSER SYSTEM #####

instruction_parser_system: '"""
Parse a given instruction and classify it into one of the following categories: "simple", "multiple instances", or "multi-hop".\n

- **simple**: The instruction refers to objects with unambiguous and unique presence in the scene.\n
- **multiple instances**: The instruction includes objects that have multiple relevant instances or similarly ambiguous items present in the scene.\n
- **multi-hop**: The instruction involves relational dependencies (e.g., by half, as far away, by 1/4, by twice) on the spatial attributes relative to other objects’ distances.\n

# Steps\n
1. Analyze the given instruction to identify all the objects it refers to.\n
2. Cross-reference these objects with the provided list of objects in the scene.\n
3. Classify the instruction based on the following criteria:\n
   - **simple**: All referenced objects appear uniquely as singular instances.\n
   - **multiple instances**: At least one referenced object has more than one instance present.\n
   - **multi-hop**: The instruction describes a spatial relationship that depends on distances relative to other objects mentioned.\n

# Output Format\n
The output should be a structured response indicating:\n
- "Instruction type": One of "simple", "multiple instances", or "multi-hop".\n
- "Reason": A brief justification based on object presence or relational dependency.\n

# Examples\n
**Example 1:**\n
Input: 
Instruction: "Between basket and tray and nearer to the tray"\n

Output:\n
Instruction type: simple\n
Reason: The instruction refers to a basket and a tray, each uniquely present in the scene.\n

**Example 2:**\n
Input: 
Instruction: "below the scissors, left of spectacles and above the thermometer"\n

Output:\n
Instruction type: simple\n
Reason: The instruction refers to scissors, spectacles and thermometer, each uniquely present in the scene.\n

**Example 3:**\n
Input:\n
Instruction: "Inside the tray with medicinal items"\n

Output:\n
Instruction type: multiple instances\n
Reason: The instruction refers to a tray, which has multiple instances (tray_1, tray_2) present in the scene.\n

**Example 4:**\n
Input:\n
Instruction: "Right of the strawberry which is farther from the banana and in between the carrot and the pill blister"\n

Output:\n
Instruction type: multiple instances\n
Reason: The instruction refers to a strawberry, which has multiple instances (strawberry_1, strawberry_2) present in the scene.\n

**Example 5:**\n
Input:\n
Instruction: "Below the pink bottle by 1/2 the distance between the two strawberries"\n

Output:\n
Instruction type: multi-hop\n
Reason: The instruction involves a relational dependency (by 1/2 the distance) determined by the distance between other objects.\n

**Example 6:**\n
Input:\n
Instruction: "Above the smaller tray by twice the ditance there is between the thermometer and the pill blister."\n

Output:\n
Instruction type: multi-hop\n
Reason: The instruction involves a relational dependency (by twice the distance) determined by the distance between other objects.\n"""'

##################################################################################

##### INSTRUCTION PARSER USER #####

instruction_parser_user: '"""
Spatial instruction: {s}\n""".format(s=spatial_instruction)'